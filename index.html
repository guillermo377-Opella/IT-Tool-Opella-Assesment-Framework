<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Technical Assessment: Digital Workplace</title>
    <style>
        body { font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background-color: #f4f6f8; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; user-select: none; }
        .container { background: white; padding: 2.5rem; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 100%; max-width: 750px; text-align: center; }
        h2 { color: #2c3e50; margin-bottom: 0.5rem; }
        .timer-box { font-size: 1.1rem; font-weight: 700; color: #e74c3c; margin: 15px 0; display: inline-block; padding: 5px 15px; background: #fdedec; border-radius: 20px; }
        .question { font-size: 1.15rem; line-height: 1.5; margin-bottom: 1.5rem; color: #34495e; font-weight: 500; min-height: 70px; display: flex; align-items: center; justify-content: center; }
        .options { display: grid; grid-template-columns: 1fr; gap: 12px; text-align: left; }
        button { padding: 14px 20px; border: 1px solid #dcdcdc; border-radius: 8px; background: #fff; cursor: pointer; transition: all 0.2s; font-size: 0.95rem; color: #444; position: relative; }
        button:hover { background-color: #ebf5fb; border-color: #3498db; color: #2980b9; }
        button:active { transform: scale(0.99); }
        .hidden { display: none; }
        .result-box { margin-top: 20px; padding: 25px; background: #2c3e50; color: white; border-radius: 8px; }
        .verification-code { background: #000; color: #00ff00; padding: 15px; font-family: 'Courier New', monospace; letter-spacing: 3px; font-size: 1.5rem; margin-top: 15px; border-radius: 4px; border: 1px solid #00ff00; }
        .progress { font-size: 0.85rem; color: #95a5a6; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px; }
        .locked-message { color: #721c24; background-color: #f8d7da; border-color: #f5c6cb; padding: 30px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
    </style>
</head>
<body>

<div class="container" id="quiz-container">
    <h2>Architecture & Infrastructure Assessment</h2>
    <div class="progress" id="progress">Initiating...</div>
    <div class="timer-box">Time Remaining: <span id="timer">20</span>s</div>
    <div class="question" id="question-text">Loading...</div>
    <div class="options" id="options-container"></div>
</div>

<div class="container hidden" id="result-container">
    <h2>Assessment Complete</h2>
    <div class="result-box">
        <p>Please email the following verification code to the recruiter immediately.</p>
        <div class="verification-code" id="verification-code">GENERATING...</div>
    </div>
    <p style="margin-top:20px; font-size:0.9rem; color:#7f8c8d;">You may close this window.</p>
</div>

<div class="container hidden" id="locked-container">
    <div class="locked-message">
        <h3>Session Locked</h3>
        <p>This assessment is limited to a single attempt.</p>
        <p>Our records indicate this test has already been completed on this device.</p>
    </div>
</div>

<script>
    // --- CONFIGURATION ---
    const TIME_PER_QUESTION = 20; // Increased slightly for reading complex questions
    
    // --- ENCRYPTION HELPER ---
    // We compare Base64 strings to ensure accuracy without revealing answers in code.
    const checkAns = (selected, encodedCorrect) => btoa(selected) === encodedCorrect;

    // --- QUESTIONS (25 Deep Technical) ---
    const questions = [
        // TEAMS & VOICE (Deep Dive)
        { 
            q: "In a Direct Routing setup with Media Bypass enabled, how does the media traffic flow for an internal user?",
            options: ["Teams Client -> Internet -> MS Cloud -> SBC", "Teams Client -> Internal Network -> SBC (No Cloud hairpin)", "Teams Client -> MS Cloud -> Media Processor -> SBC", "Teams Client -> Edge Server -> SBC"],
            a: "VGVhbXMgQ2xpZW50IC0+IEludGVybmFsIE5ldHdvcmsgLT4gU0JDIChObyBDbG91ZCBoYWlycGluKQ==" 
        },
        { 
            q: "You need to normalize a localized number format (e.g., 040-1234) to E.164 for Teams routing. Where is this regex rule applied first?",
            options: ["SBC Dial Plan", "Teams Tenant Dial Plan", "Voice Routing Policy", "PSTN Gateway"],
            a: "VGVhbXMgVGVuYW50IERpYWwgUGxhbg==" 
        },
        { 
            q: "Which PowerShell cmdlet grants a specific Voice Routing Policy to a user?",
            options: ["Grant-CsOnlineVoiceRoutingPolicy", "Set-CsOnlineVoiceRoutingPolicy", "Grant-CsTeamsCallingPolicy", "New-CsOnlineVoiceRoutingPolicy"],
            a: "R3JhbnQtQ3NPbmxpbmVWb2ljZVJvdXRpbmdQb2xpY3k=" 
        },
        { 
            q: "If an SBC certificate expires in a Direct Routing topology, what is the immediate impact?",
            options: ["Only outbound calls fail", "Only inbound calls fail", "SIP Options Ping fails, marking the trunk as 'Down'", "Media flows but signaling fails"],
            a: "U0lQIE9wdGlvbnMgUGluZyBmYWlscywgbWFya2luZyB0aGUgdHJ1bmsgYXMgJ0Rvd24n" 
        },
        { 
            q: "In Operator Connect, who manages the SBC infrastructure?",
            options: ["The Customer (You)", "Microsoft", "The Operator (Carrier)", "Shared Responsibility"],
            a: "VGhlIE9wZXJhdG9yIChDYXJyaWVyKQ==" 
        },
        
        // EXCHANGE & HYBRID
        { 
            q: "In an Exchange Hybrid deployment, what is the primary function of the Hybrid Configuration Wizard (HCW) regarding connectors?",
            options: ["It creates Receive Connectors on-prem only", "It creates Send/Receive connectors for secure mail flow (TLS) between On-Prem and O365", "It migrates MX records automatically", "It configures DAG replication to the cloud"],
            a: "SXQgY3JlYXRlcyBTZW5kL1JlY2VpdmUgY29ubmVjdG9ycyBmb3Igc2VjdXJlIG1haWwgZmxvdyAoVExTKSBiZXR3ZWVuIE9uLVByZW0gYW5kIE8zNjU=" 
        },
        { 
            q: "A user deletes an email from 'Deleted Items'. Where does it go next, and how long does it stay by default?",
            options: ["Purgatory / 30 days", "Recoverable Items (Deletions) / 14 days", "SharePoint Recycle Bin / 90 days", "Permanently deleted immediately"],
            a: "UmVjb3ZlcmFibGUgSXRlbXMgKERlbGV0aW9ucykgLyAxNCBkYXlz" 
        },
        { 
            q: "Which Exchange Online feature allows you to search across all mailboxes for eDiscovery without assigning permissions to each one?",
            options: ["Litigation Hold", "Content Search (Compliance Center)", "Journaling", "Transport Rules"],
            a: "Q29udGVudCBTZWFyY2ggKENvbXBsaWFuY2UgQ2VudGVyKQ==" 
        },
        { 
            q: "You see '450 4.4.312 DNS query failed' in message trace. What is the most likely cause?",
            options: ["Expired SPF record", "Target MX record cannot be resolved or is misconfigured", "User mailbox is full", "TLS handshake failure"],
            a: "VGFyZ2V0IE1YIHJlY29yZCBjYW5ub3QgYmUgcmVzb2x2ZWQgb3IgaXMgbWlzY29uZmlndXJlZA==" 
        },

        // ONEDRIVE & SHAREPOINT
        { 
            q: "What happens to the data when a 'Preservation Hold Library' is active on a SharePoint site and a user deletes a file?",
            options: ["The file is blocked from deletion", "The file is moved to the Preservation Hold Library and retained", "The file is deleted but index remains", "Administrator approval is required"],
            a: "VGhlIGZpbGUgaXMgbW92ZWQgdG8gdGhlIFByZXNlcnZhdGlvbiEhbGQgTGlicmFyeSBhbmQgcmV0YWluZWQ=" 
        },
        { 
            q: "For 'Known Folder Move' (KFM) to work silently, which prerequisite is critical?",
            options: ["User must be local Admin", "User must be signed in to OneDrive with the correct tenant account", "BitLocker must be enabled", "VPN must be active"],
            a: "VXNlciBtdXN0IGJlIHNpZ25lZCBpbiB0byBPbmVEcml2ZSB3aXRoIHRoZSBjb3JyZWN0IHRlbmFudCBhY2NvdW50" 
        },
        { 
            q: "What is the maximum storage limit for a standard SharePoint Online Site Collection (without purchasing extra)?",
            options: ["1 TB", "25 TB", "5 TB", "Unlimited"],
            a: "MjUgVEI=" 
        },
        
        // SECURITY & IDENTITY
        { 
            q: "Which Conditional Access setting prevents legacy authentication (IMAP/POP/SMTP)?",
            options: ["Client Apps condition -> Uncheck 'Other clients'", "User Risk Policy", "MFA Enforcement", "Sign-in Risk Policy"],
            a: "Q2xpZW50IEFwcHMgY29uZGl0aW9uIC0+IFVuY2hlY2sgJ090aGVyIGNsaWVudHMn" 
        },
        { 
            q: "To grant an external vendor access to a single Team without giving them a full license, what is the best method?",
            options: ["Create a licensed user for them", "Azure B2B Guest Access", "Share credentials", "Federated Trust"],
            a: "QXp1cmUgQjJCIEd1ZXN0IEFjY2Vzcw==" 
        },
        { 
            q: "What is the primary difference between 'Password Hash Sync' (PHS) and 'Pass-through Authentication' (PTA)?",
            options: ["PHS requires ADFS", "PTA validates passwords against on-prem AD in real-time", "PHS is less secure", "PTA does not support MFA"],
            a: "UFRBIHZhbGlkYXRlcyBwYXNzd29yZHMgYWdhaW5zdCBvbi1wcmVtIEFEIGluIHJlYWwtdGltZQ==" 
        },

        // ARCHITECTURE & GENERAL
        { 
            q: "In a VDI/Cloud PC environment, why is 'Split Tunneling' recommended for Teams traffic?",
            options: ["To encrypt traffic twice", "To offload audio/video traffic directly to the Internet instead of the VPN concentrator", "To route traffic via the Datacenter for inspection", "To disable video"],
            a: "VG8gb2ZmbG9hZCBhdWRpby92aWRlbyB0cmFmZmljIGRpcmVjdGx5IHRvIHRoZSBJbnRlcm5ldCBpbnN0ZWFkIG9mIHRoZSBWUE4gY29uY2VudHJhdG9y" 
        },
        { 
            q: "Which DNS record type is used by Teams Auto Discovery (SRV)?",
            options: ["_sip._tls", "_teams._tcp", "autodiscover.xml", "sip.internal"],
            a: "X3NpcC5fdGxz" 
        },
        { 
            q: "If you need to prevent users from forwarding a sensitive email to external addresses, what do you use?",
            options: ["Transport Rule", "Information Rights Management (IRM) / Sensitivity Labels", "S/MIME", "DKIM"],
            a: "SW5mb3JtYXRpb24gUmlnaHRzIE1hbmFnZW1lbnQgKElSTSkgLyBTZW5zaXRpdml0eSBMYWJlbHM=" 
        },
        { 
            q: "What is the 'Semantic Index' in the context of Copilot for M365?",
            options: ["A list of user passwords", "A map of user and data relationships (Graph) used to ground AI responses", "The SharePoint search crawler", "An Exchange database"],
            a: "QSBtYXAgb2YgdXNlciBhbmQgZGF0YSByZWxhdGlvbnNoaXBzIChHcmFwaCkgdXNlZCB0byBncm91bmQgQUkgcmVzcG9uc2Vz" 
        },
        { 
            q: "Which command would you use to force a specific directory sync cycle in AD Connect?",
            options: ["Start-ADSyncSyncCycle -PolicyType Delta", "Update-ADSync", "Sync-Now", "Force-DirSync"],
            a: "U3RhcnQtQURTeW5jU3luY0N5Y2xlIC1Qb2xpY3lUeXBlIERlbHRh" 
        },
        
        // SCENARIO
        { 
            q: "A user complains their Teams Status is unknown and Calendar is missing. What is the most likely root cause?",
            options: ["Teams License is missing", "Exchange Web Services (EWS) is blocked or failing", "SIP Address mismatch", "OneDrive is full"],
            a: "RXhjaGFuZ2UgV2ViIFNlcnZpY2VzIChFV1MpIGlzIGJsb2NrZWQgb3IgZmFpbGluZw==" 
        },
        { 
            q: "You need to retain Chats for 7 years but delete Channel messages after 3 years. How do you configure this?",
            options: ["Two separate Retention Policies applied to different scopes", "One policy with a condition", "It is not possible", "Use Legal Hold"],
            a: "VHdvIHNlcGFyYXRlIFJldGVudGlvbiBQb2xpY2llcyBhcHBsaWVkIHRvIGRpZmZlcmVudCBzY29wZXM=" 
        },
        { 
            q: "What is the main advantage of 'Microsoft 365 Groups' over traditional Security Groups?",
            options: ["They have no owners", "They provide a shared workspace (Mailbox, Calendar, Site, Team) automatically", "They are on-prem only", "They don't sync to Azure AD"],
            a: "VGhleSBwcm92aWRlIGEgc2hhcmVkIHdvcmtzcGFjZSAoTWFpbGJveCwgQ2FsZW5kYXIsIFNpdGUsIFRlYW0pIGF1dG9tYXRpY2FsbHk=" 
        },
        { 
            q: "When using PIM (Privileged Identity Management), what is 'Just-In-Time' access?",
            options: ["Users have Admin rights permanently", "Users request Admin rights only when needed for a specific duration", "Admin rights are disabled", "Rights are granted via script"],
            a: "VXNlcnMgcmVxdWVzdCBBZG1pbiByaWdodHMgb25seSB3aGVuIG5lZWRlZCBmb3IgYSBzcGVjaWZpYyBkdXJhdGlvbg==" 
        },
        { 
            q: "Which tool provides the 'Productivity Score' and 'Endpoint Analytics'?",
            options: ["Intune / Endpoint Manager", "M365 Admin Center / Viva Insights", "Azure Active Directory", "Exchange Admin Center"],
            a: "TTM2NSBBZG1pbiBDZW50ZXIgLyBWaXZhIEluc2lnaHRz" 
        }
    ];

    // --- STATE MANAGEMENT ---
    let currentQ = 0;
    let score = 0;
    let timeLeft = TIME_PER_QUESTION;
    let timerInterval;

    // --- DOM ELEMENTS ---
    const quizContainer = document.getElementById('quiz-container');
    const resultContainer = document.getElementById('result-container');
    const lockedContainer = document.getElementById('locked-container');
    const questionText = document.getElementById('question-text');
    const optionsContainer = document.getElementById('options-container');
    const timerDisplay = document.getElementById('timer');
    const progressDisplay = document.getElementById('progress');

    // --- ONE ATTEMPT CHECK (Local Storage) ---
    // If you want to reset this for yourself, open DevTools -> Application -> Local Storage -> Right click -> Clear
    if (localStorage.getItem('nanda_tech_assess_v2')) {
        quizContainer.classList.add('hidden');
        lockedContainer.classList.remove('hidden');
    } else {
        startQuiz();
    }

    function startQuiz() {
        loadQuestion();
    }

    function startTimer() {
        timeLeft = TIME_PER_QUESTION;
        timerDisplay.innerText = timeLeft;
        clearInterval(timerInterval);
        timerInterval = setInterval(() => {
            timeLeft--;
            timerDisplay.innerText = timeLeft;
            if (timeLeft <= 0) {
                clearInterval(timerInterval);
                recordAnswer(null); // Time out = wrong
            }
        }, 1000);
    }

    function loadQuestion() {
        if (currentQ >= questions.length) {
            finishQuiz();
            return;
        }
        
        const qData = questions[currentQ];
        questionText.innerText = qData.q;
        optionsContainer.innerHTML = '';
        progressDisplay.innerText = `QUESTION ${currentQ + 1} OF ${questions.length}`;

        // Randomize options for display
        const shuffledOptions = [...qData.options].sort(() => Math.random() - 0.5);

        shuffledOptions.forEach(opt => {
            const btn = document.createElement('button');
            btn.innerText = opt;
            btn.onclick = () => recordAnswer(opt);
            optionsContainer.appendChild(btn);
        });

        startTimer();
    }

    function recordAnswer(selectedOption) {
        clearInterval(timerInterval);
        
        // Base64 Check - Secure and bug-free
        if (selectedOption && checkAns(selectedOption, questions[currentQ].a)) {
            score++;
        }
        
        currentQ++;
        loadQuestion();
    }

    function finishQuiz() {
        // Lock the test
        localStorage.setItem('nanda_tech_assess_v2', 'true');

        quizContainer.classList.add('hidden');
        resultContainer.classList.remove('hidden');

        // --- NEW OBFUSCATED SCORING LOGIC ---
        // Formula: Hex((Score + 18) * 3)
        // 1. Add 18 to score. 2. Multiply by 3. 3. Convert to Hex.
        // This hides the number completely. 
        // Example: Score 0 -> (0+18)*3 = 54 -> Hex 36
        // Example: Score 25 -> (25+18)*3 = 129 -> Hex 81
        
        const calculatedVal = (score + 18) * 3;
        const hexVal = calculatedVal.toString(16).toUpperCase();
        
        // Random noise generator for the prefix/middle
        const randStr = Math.random().toString(36).substring(2, 5).toUpperCase();
        
        // Final Code Structure: NK-[Random]-[HexScore]
        const code = `NK-${randStr}-${hexVal}`;
        
        document.getElementById('verification-code').innerText = code;
    }

    // --- SECURITY DETERRENTS ---
    document.addEventListener('contextmenu', event => event.preventDefault());
    document.onkeydown = function(e) {
        if(e.keyCode == 123) return false;
        if(e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0)) return false;
        if(e.ctrlKey && e.shiftKey && e.keyCode == 'C'.charCodeAt(0)) return false;
        if(e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)) return false;
    }
</script>

</body>
</html>